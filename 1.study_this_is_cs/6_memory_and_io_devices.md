# 보조기억장치와 입출력장치
    보조기억장치는 메모리의 휘발성을 보완하고 메모리보다 큰 저장 공간을 제공한다.
    보조기억장치에 저장된 정보를 안정적이고 안전하게 관리하는 RAID 와 보조기억장치를 포함한 다양한 입출력장치가 입출력을 수행하는 방법을 학습할 것 

<!-- TOC -->
* [보조기억장치와 입출력장치](#보조기억장치와-입출력장치)
  * [RAID](#raid)
      * [RAID:데이터의 안정성 혹은 성능확보를 위해 여러개의 독립적인 보조기억장치를 하나의 보조기억장치처럼 사용하는 기술](#raid데이터의-안정성-혹은-성능확보를-위해-여러개의-독립적인-보조기억장치를-하나의-보조기억장치처럼-사용하는-기술)
    * [RAID0](#raid0)
    * [RAID1](#raid1)
    * [RAID4](#raid4)
    * [RAID5](#raid5)
    * [RAID6](#raid6)
  * [입출력 기법](#입출력-기법)
    * [장치 컨트롤러와 장치 드라이버](#장치-컨트롤러와-장치-드라이버)
      * [장치 컨트롤러: CPU와 입출력장치 사이의 통신을 중개하는 중개자 역할의 하드웨어](#장치-컨트롤러-cpu와-입출력장치-사이의-통신을-중개하는-중개자-역할의-하드웨어)
      * [장치 드라이버 : 장치 컨트롤러의 동작을 알고, 장치 컨트롤러가 컴퓨터 내부와 정보를 주고받을 수 있도록 하는 프로그램](#장치-드라이버--장치-컨트롤러의-동작을-알고-장치-컨트롤러가-컴퓨터-내부와-정보를-주고받을-수-있도록-하는-프로그램)
    * [입출력작업을 수행하는 방법 3가지 (프로그램 입출력, 인터럽트 기반 입출력. DMA 입출력)](#입출력작업을-수행하는-방법-3가지-프로그램-입출력-인터럽트-기반-입출력-dma-입출력)
    * [프로그램 입출력](#프로그램-입출력)
    * [인터럽트 기반 입출력: 다중 인터럽트](#인터럽트-기반-입출력-다중-인터럽트)
    * [DMA 입출력](#dma-입출력)
<!-- TOC -->

## RAID
- 대중적으로 활용되고 있는 보조기억장치는 크게 2가지 있다. **하드 디스크 드라이브(이하 하드 디스크)** 와 **플래시 메모리 기반 저장장치**
- 하드디스크는 자기적인 방식으로 데이터를 읽고 쓰는 보조기억장치.동그란 원판은 플래터,원판 위에 있는 뽀족한 리더기인 헤드를 통해 플래터에 저장된 데이터에 접근한다.
- 플래시 메모리는 전기적인 방식으로 데이터를 읽고 쓰는 반도체 기반의 저장장치이다. 우리가 흔히 사용하는 SSD, SD카드, USB 메모리 전부 플래시 메모리 기반
- 보조기억장치의 본분은 두가지 1. 전원이 꺼져도 데이터를 안전하게 보관하는 것 2. CPU가 필요로 하는 정보를 조금이라도 빠른 성능으로 메모리에게 전달하는 것 
#### RAID:데이터의 안정성 혹은 성능확보를 위해 여러개의 독립적인 보조기억장치를 하나의 보조기억장치처럼 사용하는 기술
- RAID를 구성하는 방법은 여러 가지가 있고, RAID 레벨이라고 표현한다. RAID0, RAID1, RAID3... 등이 있다.

### RAID0
- 데이터를 여러 보조기억장치에 단순하게 나누어 저장하는 구성 방식
- 줄무늬처럼 분산되어 저장된 데이터를 스트라입이라고 하고, 분산하여 저장하는 동작을 스트라이핑이라고 한다.
- 빠른 입출력 속도가 장접이다. 데이터를 한 번에, 동시에 읽고 쓸 수 있기 때문이다.
- A1, A2, A3, A4를 동시에 읽어들이면 하드 디스크 1~4에서 동시에, 한 번에 읽어 들일 수 이다. 4TB 저장장치 1개보다 RAID0으로 구성 된 1TB 저장장치 4개가 4배 더 빠르다.
- 저장된 정보가 안전하지 않다는 단점이 있다. 하드 디스크 1에 문제가 생기면 나머지 2,3,4 의 데이터가 불완전한 데이터가 된다.

![RAID0](https://csnote.net/assets/img/arch/raid0.png)

### RAID1
- 완전한 복사본을만들어 저장하는 구성 방식으로 미러링이라고도 부른다.
- 복구가 간단하고 안정성이 높다.
- RAID1에 데이터를 쓸 때 원본과 복사본 두 곳에 써야해서 RAID0 보다 쓰기 속도가 느려지고, 사용 가능한 용량도 적어진다.

![RAID2](https://csnote.net/assets/img/arch/raid1.png)

### RAID4
- 패리티 정보를 저장하는 디스크를 따로 두는 구성 방식, 오류 검출용 장치를 따로 두면 RAID1에 비해 적은 하드 디스크로 안전하게 데이터를 보관할 수 있다.  
  - 패리티는 오류를 검츨할 수 있는 정보를 말한다. 
- 병목 현상이 발생할 수 있는 단점이 있다. 새 데이터를 적을 때 디스크4에도 쓰기 작업을 하면서 해당 현상이 발생할 수 있다. 

![RAID4](https://csnote.net/assets/img/arch/raid4.png)

### RAID5
- 패리티를 분산하여 저장하는 구성 방식이다. RAID4의 단점인 병목현상을 보완할 수 있다. 

![RAID5](https://csnote.net/assets/img/arch/raid5.png)

### RAID6
- 기본 구성은 RIAD5와 같으나 서로 다른 2개의 패리티를 두는 구성 방식이다. 
- 오류를 검출하고 복구할 수 있는 수단이  2개가 생긴 셈이고 안정성이 높다. 
- 데이터를 저장할 때 함께 저장할 패리티가 2개이므로 RAID5에 비해 쓰기 속도는 일반적으로 느리다.

![RAID6](https://csnote.net/assets/img/arch/raid6.png)

`🐣 Nested RAID: 여러 RAID 레벨을 혼합한 방식`

## 입출력 기법
- 입출력 기법: 보조기억장치를 포함한 다양한 입출력장치들이 컴퓨터 내부와 정보를 주고받는 방식

### 장치 컨트롤러와 장치 드라이버
- 다양한 외부 장치가 컴퓨터 내부와 어떻게 연결되고 소통하는지 알기 위해 **장치 컨트롤러**와 **장치 드라이버**의 개념을 알아야 한다. 
- 입출력장치는 너무 다양하다.(키보드, 마우스, 모니터 등등) CPU가 모든 작동 방식을 아는 것이 어려워 입출력장치는 장치 컨트롤러라는 하드웨어를 통해 연결이 된다.
#### 장치 컨트롤러: CPU와 입출력장치 사이의 통신을 중개하는 중개자 역할의 하드웨어
`장치 컨트롤러에는 RAM과 같은 저장장치가 있는 경우가 많다. 기억할 값들이 많기 때문이다. 휘발성인 경우가 많아 안전 제거하지 않으면 입출력데이터에 문제가 생길 수 있다.`
#### 장치 드라이버 : 장치 컨트롤러의 동작을 알고, 장치 컨트롤러가 컴퓨터 내부와 정보를 주고받을 수 있도록 하는 프로그램
- CPU가 실행하는 것은 프로그램이다. CPU가 장치 컨트롤러와 상호작용함으로써 입출력장치를 작동시키는 것 또한 CPU가 실행하는 프로그램으로 이루어진다는 것. 해당 프로그램이 장치 드라이버이다.
- 대부분의 장치 드라이버는 기본적으로 윈도우, 맥OS와 같은 운영체제에 포함되어 별도의 설치가 필요없다. 하지만 일반적이지 않은 입출력장치(대형 프린터기)같은 경우
별도의 장치 드라이버를 설치해야 한다. 

### 입출력작업을 수행하는 방법 3가지 (프로그램 입출력, 인터럽트 기반 입출력. DMA 입출력)
### 프로그램 입출력
- 프로그램 입출력: 프로그램 속 명령어(입출력 명령어)로 입출력 작업을 수행하는 방법
- 프린터 컨트롤러의 상태를 확인하라와 같은 입출력 명령어를 실행함으로써 장티 컨트롤러와 상호작용하고, 이를 통해 입출력 작업을 수행한다.


>  #### 프로그램 입출력 의 두 종류
>  프로그램 입출력 방식은 입출력 명령어의 오퍼랜드, 입출력장치의 주소를 식별하는 방식에 따라 고립형 입출력, 메모리 맵 입출력 으로 나뉜다.
> 
> | 입출력 방식   | 특징                                                 | 주소 공간에 접근 시 별도의 입출력 명령어 필요 유무 |
> |----------|----------------------------------------------------|-------------------------------|
> |  고립형 입출력  | 입출력장치에 접근하는 주소와 메모리에 접근하는 주소를 별도의 주소 공간으로 간주       | O                             |
> |  메모리 맵 입출력 | 메모리에 부여된 주소 공간 일부를 입출력장치를 식별하기 위한 주소 공간으로 사용하는 방식  | X                             | 

### 인터럽트 기반 입출력: 다중 인터럽트

- 인터럽트 기반 입출력 중 좀더 일반적인 상황인 다중 인터럽트 처리 : 키보드, 마우스, 모니터, 스피커 등의 입출력 장치를 동시에 사용하는 상황에
CPU는 동시 다발적으로 발생하는 인터럽트들을 모두 처리해야 한다. 
- CPU가 플래그 레지스터 속 인터럽트 비트를 비활성화 한 채 인터럽트를 처리할 경우, 다른 하드웨어 인터럽트를 받아들이지 않아 기본적으로 순서대로 인터럽트 서비스 루틴을 실행한다.
- 하지만, 인터럽트 중에서 우선순위가 더 높은 인터럽트가 우선적으로 처리된다. 
  - 지금 처리중인 인터럽트A보다 인터럽트 B의 우선순위가 낮다면, A를 다 처리하고 B를 처리한다. 
  - B의 우선순위가 높다면 CPU는 인터럽트 A의 실행을 멈추고 B를 철리한 뒤 다시 A를 처리하게 된다.  
- CPU는 플래그 레지스터 속 인터럽트 비트가 활성화되어 있는 경우, 또한 인터럽트 비트를 비활성화해도 무시할 수 없는 인터럽트 NMI가 발생하면 우선순위가 높은 인터럽트부터 먼저 처리한다.
#### PIC: 다중 인터럽트를 처리하기 위해서는 **프로그래머블 인터럽트 컨트롤러**(PIC)라는 하드웨어가 사용된다.
- PIC는 여러 장치 컨트롤러에 연결되어 있어 장치 컨트롤러에서 보낸 하드웨어 인터럽트 요청을 보낼 수 있도록 약속된 하드웨어가 연결되어 있다. 
- ex> 첫번 째 핀은 타이머 인터럽트. 두번 째 핀은 키보드 인터럽트 등..
- 일반적으로 많은 하드웨어 인터럽트를 관리하기 위해 2개 이상의 계층으로 구성이 된다.

### DMA 입출력