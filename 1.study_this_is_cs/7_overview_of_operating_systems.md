# 운영체제의 큰 그림
    운영체제는 특별한 프로그램이다. 대표적으로 윈도우, 맥OS, 리눅스는 데스크탑의 운영체제이고, 안드로이드와 iOS는 스마트폰의 운영체제이다.
    운영체제의 핵심 기능을 담당하는 부분으로 하드웨어를 비롯한 자원과 프로세스 및 스레드를 관리하는 것을 커널이라고 한다. 
    운영체제에는 크게 두가지 기능이 있다. 1. 자원 할당 및 관리 2. 프로세스 및 스레드 관리

<!-- TOC -->
* [운영체제의 큰 그림](#운영체제의-큰-그림)
  * [운영체제의 역할](#운영체제의-역할)
    * [CPU 관리: CPU 스케줄링](#cpu-관리-cpu-스케줄링)
    * [메모리 관리: 가상 메모리](#메모리-관리-가상-메모리)
      * [가상메모리: 운영체제의 메모리 관리 기법 중 하나, 실제 물리적인 메모리 크기보다 더 큰 메모리를 이용할 수 있도록 하는 기술이다.](#가상메모리-운영체제의-메모리-관리-기법-중-하나-실제-물리적인-메모리-크기보다-더-큰-메모리를-이용할-수-있도록-하는-기술이다)
    * [파일/디렉터리 관리: 파일 시스템](#파일디렉터리-관리-파일-시스템)
    * [프로세스 및 스레드 관리](#프로세스-및-스레드-관리-)
  * [시스템 콜과 이중 모드](#시스템-콜과-이중-모드)
      * [시스템 콜: 운영체제의 서비스를 제공받기 위한 수단으로, 호출 가능한 함수의 형태를 가진다.](#시스템-콜-운영체제의-서비스를-제공받기-위한-수단으로-호출-가능한-함수의-형태를-가진다-)
      * [사용자 모드: 사용자 영역에 적재된 코드를 실행할 떄의 실행모드](#사용자-모드-사용자-영역에-적재된-코드를-실행할-떄의-실행모드-)
      * [커널 모드: 커널 영역에 적재된 코드를 실행할 떄의 실행 모드](#커널-모드-커널-영역에-적재된-코드를-실행할-떄의-실행-모드)
      * [이중 모드: 2개의 모드를 구분하여 실행하는 것](#이중-모드-2개의-모드를-구분하여-실행하는-것)
<!-- TOC -->

## 운영체제의 역할
- 우선적으로 **자원**이 무엇인지 이해해야 한다. 시스템 자원이라고도 하고 프로그램 실행에 마땅히 필요한 요소를 의미한다.
- 실행에 필요한 '데이터'를 자원(소프트웨어)이라고 하기도 하고, 실행에 필요한 '부품'을 자원(하드웨어)라고 하기도 한다. 
- 운영체제는 응용 프로그램을 대신해 CPU, 메모리, 보조기억장치 등의 컴퓨터 부품에 접근하고, 각각의 부품들이 효율적으로 사용되도록 관리한다.
- 또한 응용 프로그램이 컴퓨터 부품들을 효율적으로 할당받아 문제 없이 실행할 수 있도록 응용 프로그램에게 자원을 할당한다. 

### CPU 관리: CPU 스케줄링
- CPU는 한정된 자원이기에 CPU를 할당받아 사용하기 위해 때로는 다른 프로그램이 CPU 사용이 끝날 때 까지 기다려야 한다.
- 운영체제는 실행 중인 모든 프로그램들이 공정하고 합리적으로 CPU를 할당받도록 CPU의 할당 순서와 사용 시간을 결정한다.

### 메모리 관리: 가상 메모리
- 운영체제는 새롭게 실행하는 프로그램을 메모리에 적재하고, 종료된 프로그램을 메모리에서 삭제한다. 또한,낭비되는 메모리 용량이 없도록 효율적으로 관리해야 한다.
- 오늘날의 운영체제들은 이를 위해 가상 메모리를 활용한다.
#### 가상메모리: 운영체제의 메모리 관리 기법 중 하나, 실제 물리적인 메모리 크기보다 더 큰 메모리를 이용할 수 있도록 하는 기술이다.

### 파일/디렉터리 관리: 파일 시스템
- 운영체제는 보조기억장치를 효율적으로 관리하기 위해 파일 시스템을 활용한다.
- 파일 시스템은 보조기억장치 내의 정보를 파일 및 폴더단위로 접근-관리할 수 있도록 만드는 운영체제 내부 프로그램이다. 

### 프로세스 및 스레드 관리 
- 단순히 실행중인 프로그램으로 지칭한 대상은 **프로세스**고 해당 프로세스를 이루고 있는 실행의 단위는 **스레드**이다. 
- 메모리에는 여러 프로세스가 적재될 수 있는데, 운영체제는 이 프로세스에 필요한 자원을 할당하고, 스레드는 프로세스가 할당받은 자원을 이용해 프로세스의 작업을 수행한다.
- 스레드가 둘 이상인 경우에는 동일한 작업을 동시에 실행할 수도 있다.
- 운영체제는 동시다발적으로 실행되는 프로세스와 스레드가 올바르게 처리되도록 실행의 순서를 제어하고, 프로세스와 스레드가 요구하는 자원을 적절하게 배분할 수 있어야 한다.

## 시스템 콜과 이중 모드
- 운영체제도 일종의 프로그램이어서, 프로그램이 실행되기 위해서는 반드시 메모리에 적재되어야 한다. 
- 다만, 운영체제는 매우 특별한 프로그램이어서 메모리 내의 **커널 영역**이라는 공간에 따로 적재되어 실행된다.
- 운영체제가 적재되는 커널 영역 외에 사용자 응용 프로그램이 적재되는 공간은 **사용자 영역**이다.
- 중요한 점운영체제의 기능을 제공받기 위해서는 커널 영역에 적재된 운영체제 코드를 실행해야 한다.

!["커널 영역"](https://csnote.net/assets/img/os/kernel_space.png )

- 웹 브라우저나 게임과 같은 응용 프로그램은 운영체제와 달리 CPU, 메모리와 같은 자원에 직접 접근하거나 조작할 수 없다.
- 운영체제가 자신의 코드를 실행한 응용 프로그램의 자원 접근 및 조작을 대행하는 셈이다.
- 응용프로그램은 시스템 콜을 호출해 운영체제 코드를 실행할 수 있다. 
#### 시스템 콜: 운영체제의 서비스를 제공받기 위한 수단으로, 호출 가능한 함수의 형태를 가진다. 
- 응용 프로그램이 운영체제로부터 어떤 기능을 제공 받고자 하면, 그 기능에 해당하는 시스템 콜을 호출하면 된다.
  !["시스템 호출"](https://csnote.net/assets/img/os/syscall.png )
- 운영체제에 따라 제공하는 시스템 콜의 종류와 개수는 다양하다.
- 컴퓨터 내부에서 시스템 콜이 호출되면 발생되는 일의 순서, 핵심은 소프트웨어 인터럽트와 커널 모드, 사용자 모드이다.
1. 소프트웨어 인터럽트 발생
2. CPU의 커널모드 전환
3. 운영체제 코드 실행
4. 사용자 모드로 재전환

- 운영체제에는 인터럽트를 발생시키는 특정 명령어가 있다. 
- 자원에 접근하는 입출력 명령어가 대 표적이고, 이러한 명령어에 의해 발생하는 인터럽트를 소프트웨어 인터럽트라 한다.
- 시스템 콜이 이런 소프트웨어 인터럽트의 일종
- CPU 는 명령어를 실행하는 과정에서 서용자 영역을 실행할 때의 모드와 커널 영역을 실행할 때의 모드를 구분하여 실행한다.
#### 사용자 모드: 사용자 영역에 적재된 코드를 실행할 떄의 실행모드 
- 운영체제 서비그를 제공받을 수 없는 실행 모드로, 커널 영역의 코드를 실행할 수 없는 모드이다.
- 해당 모드로 실행 중인 CPU는 입출력 명령어와 같이 가원에 접근하는 명령어를 만나도 이를 실행하지 않는다. 
- 실수로 자원에 접근하는 것을 막을 수 있다. 
#### 커널 모드: 커널 영역에 적재된 코드를 실행할 떄의 실행 모드
- 운영체제 서비스를 제공받을 수 있는 실행 모드, 커널 영역의 코드를 실행 할 수 있는 모드
- CPU가 커널모드로 명령어를 실행하면 자원에 접근하는 명령어를 비롯한 모든 명령어를 실행할 수 있다. 
- 운영체제는 해당 모드로 실행되기 때문에 자원에 접근할 수 있다.
#### 이중 모드: 2개의 모드를 구분하여 실행하는 것

- 응용 프로그램은 실행 과정에서 시스템 콜을 매우 빈번하게 호출한다.
- 프로그램은 시스템 콜을 통해 사용자 모드와 커널 모드를 빈번히 오가며 운영체제의 소스 코드를 실행한다.
